set(CMAKE_BUILD_TYPE Release CACHE STRING "")
set(LLVM_ENABLE_PROJECTS "clang;clang-tools-extra;lld" CACHE STRING "")
set(LLVM_ENABLE_RUNTIMES "compiler-rt;libcxx;libcxxabi;libunwind" CACHE STRING "")
set(LLVM_TARGETS_TO_BUILD "X86" CACHE STRING "")
# set(LLVM_USE_LINKER "lld" CACHE STRING "")
set(LLVM_ENABLE_LLD ON CACHE BOOL "")
set(LLVM_DEFAULT_TARGET_TRIPLE "x86_64-unknown-m2" CACHE STRING "")

# 빌트인/런타임 크로스 대상
set(LLVM_ENABLE_PER_TARGET_RUNTIME_DIR ON CACHE BOOL "")

set(CLANG_DEFAULT_CXX_STDLIB libc++ CACHE STRING "")
set(CLANG_DEFAULT_LINKER lld CACHE STRING "")
set(CLANG_DEFAULT_OBJCOPY llvm-objcopy CACHE STRING "")
set(CLANG_DEFAULT_RTLIB compiler-rt CACHE STRING "")
set(CLANG_DEFAULT_UNWINDLIB libunwind CACHE STRING "")
set(CLANG_ENABLE_STATIC_ANALYZER ON CACHE BOOL "")

# 설치할 sysroot(출력 위치) 지정
# set(m2_SYSROOT "${CMAKE_SOURCE_DIR}/../m2-sysroot-x86_64" CACHE PATH "")

# === compiler-rt builtins 설정 ===
set("BUILTINS_x86_64-unknown-m2_CMAKE_SYSTEM_NAME" "M2" CACHE STRING "")
set("BUILTINS_x86_64-unknown-m2_CMAKE_TRY_COMPILE_TARGET_TYPE" "STATIC_LIBRARY" CACHE STRING "")
set("BUILTINS_x86_64-unknown-m2_COMPILER_RT_BAREMETAL_BUILD" ON CACHE BOOL "")
set("BUILTINS_x86_64-unknown-m2_COMPILER_RT_DEFAULT_TARGET_ONLY" ON CACHE BOOL "")
set("BUILTINS_x86_64-unknown-m2_CMAKE_SYSROOT" ${M2_SYSROOT} CACHE STRING "")
set("BUILTINS_x86_64-unknown-m2_CMAKE_C_FLAGS"
    "--target=x86_64-unknown-m2" CACHE STRING "")
set("BUILTINS_x86_64-unknown-m2_CMAKE_CXX_FLAGS"
    "--target=x86_64-unknown-m2" CACHE STRING "")
# 필요 시: set("BUILTINS_x86_64-unknown-m2_CMAKE_ASM_COMPILER_TARGET" "x86_64-unknown-m2" CACHE STRING "")

# === libc++/abi/unwind 런타임 설정 ===
set("RUNTIMES_x86_64-unknown-m2_CMAKE_SYSTEM_NAME" "M2" CACHE STRING "")
set("RUNTIMES_x86_64-unknown-m2_CMAKE_TRY_COMPILE_TARGET_TYPE" "STATIC_LIBRARY" CACHE STRING "")
set("RUNTIMES_x86_64-unknown-m2_BUILD_SHARED_LIBS" OFF CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_CMAKE_SYSROOT" ${M2_SYSROOT} CACHE STRING "")
# set("RUNTIMES_x86_64-unknown-m2_CMAKE_INSTALL_PREFIX" "${m2_SYSROOT}" CACHE PATH "")

# Bare-metal 친화 옵션 (스레드/파일시스템/로케일/예외 비활성화 등)
set("RUNTIMES_x86_64-unknown-m2_LIBCXX_ENABLE_SHARED" OFF CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBCXX_ENABLE_STATIC" ON CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBCXX_ENABLE_THREADS" OFF CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBCXX_ENABLE_EXCEPTIONS" OFF CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBCXX_ENABLE_FILESYSTEM" OFF CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBCXX_ENABLE_LOCALIZATION" OFF CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBCXX_USE_COMPILER_RT" ON CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBCXX_ENABLE_WIDE_CHARACTERS" OFF CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBCXX_ENABLE_MONOTONIC_CLOCK" OFF CACHE BOOL "")

set("RUNTIMES_x86_64-unknown-m2_LIBCXXABI_ENABLE_SHARED" OFF CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBCXXABI_ENABLE_THREADS" OFF CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBCXXABI_ENABLE_EXCEPTIONS" OFF CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBCXXABI_USE_COMPILER_RT" ON CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBUNWIND_INSTALL_LIBRARY" OFF CACHE BOOL "")
# set("RUNTIMES_x86_64-unknown-m2_LIBUNWIND_INSTALL_STATIC_LIBRARY" ON CACHE BOOL "")
# set("RUNTIMES_x86_64-unknown-m2_LIBUNWIND_ENABLE_SHARED" OFF CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LLVM_ENABLE_RUNTIMES" "compiler-rt;libcxx;libcxxabi;libunwind" CACHE STRING "")
# 일부 환경에서: set("RUNTIMES_x86_64-unknown-m2_LIBCXXABI_BAREMETAL" ON CACHE BOOL "")

# LIBCXX_ENABLE_MONOTONIC_CLOCK
# libunwind: 베어메탈 스위치 & compiler-rt 사용
set("RUNTIMES_x86_64-unknown-m2_LIBUNWIND_ENABLE_SHARED" OFF CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBUNWIND_ENABLE_THREADS" OFF CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBUNWIND_ENABLE_EXCEPTIONS" OFF CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBUNWIND_ENABLE_FILESYSTEM" OFF CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBUNWIND_ENABLE_LOCALIZATION" OFF CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBUNWIND_USE_COMPILER_RT" ON CACHE BOOL "")
set("RUNTIMES_x86_64-unknown-m2_LIBUNWIND_IS_BAREMETAL" ON CACHE BOOL "")

# (선택) long double 제거 & freestanding 강제
set("RUNTIMES_x86_64-unknown-m2_CMAKE_C_FLAGS"
    "" CACHE STRING "")
set("RUNTIMES_x86_64-unknown-m2_CMAKE_CXX_FLAGS"
    "" CACHE STRING "")

set(LLVM_BUILTIN_TARGETS "x86_64-unknown-m2" CACHE STRING "")
set(LLVM_RUNTIME_TARGETS "x86_64-unknown-m2" CACHE STRING "")